import fse from 'fs-extra';
import { DOT_MINTLIFY, DOT_MINTLIFY_LAST, MINT_CLIENT_RELEASES_CLOUDFRONT_URL, VERSION_PATH, } from './constants.js';
export const getFileExtension = (filename) => {
    const ext = filename.substring(filename.lastIndexOf('.') + 1, filename.length);
    if (filename === ext)
        return undefined;
    return ext;
};
export const maybeFixMissingWindowsEnvVar = () => {
    if (process.platform === 'win32' &&
        !('SYSTEMROOT' in process.env) &&
        'SystemRoot' in process.env) {
        process.env.SYSTEMROOT = process.env.SystemRoot;
    }
};
export const restoreMintlifyLast = () => {
    if (fse.existsSync(DOT_MINTLIFY_LAST)) {
        fse.removeSync(DOT_MINTLIFY);
        fse.moveSync(DOT_MINTLIFY_LAST, DOT_MINTLIFY);
    }
};
export const getTarUrl = (version) => {
    return `${MINT_CLIENT_RELEASES_CLOUDFRONT_URL}/mint-${version}.tar.gz`;
};
export const getClientVersion = () => {
    if (process.env.CLI_TEST_MODE === 'true') {
        return 'test-client';
    }
    if (fse.existsSync(VERSION_PATH)) {
        return fse.readFileSync(VERSION_PATH, 'utf8');
    }
    return 'none';
};
